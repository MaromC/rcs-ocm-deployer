apiVersion: kuttl.dev/v1beta1
kind: TestStep
timeout: 30
commands:
  - command: bash -c "export placement=$(sh ../getClusteOrPlacement.sh placement); yq e -i 'select(di == 1).spec.site = env(placement)' 02-deploy-capp-with-placement.yaml"
---
apiVersion: rcs.dana.io/v1alpha1
kind: Capp
metadata:
  name: capp-with-placement
spec:
  site: placement
  configurationSpec:
    template:
      metadata:
        creationTimestamp: null
      spec:
        containers:
          - env:
              - name: APP_NAME
                value: capp-with-placement
            image: 'sahar2339/example-python-app:v1-flask'
            name: capp-with-placement
            resources: {}
  routeSpec:
    hostname: rbacsdgesdn.dev
  scaleMetric: cpu
